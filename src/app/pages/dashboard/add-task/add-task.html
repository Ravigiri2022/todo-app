<div
  id="bg-popup"
  class="absolute inset-0 z-30 backdrop-blur-[3px] bg-white/20 flex items-center fade-in justify-center"
  (click)="closeForm()"
  (click)="$event.stopPropagation()"
>
  <div
    id="popup"
    class="bg-white/90 border border-white z-60 rounded-2xl p-6 w-full max-w-md mx-4 bottom-slide-up shadow-lg"
    (click)="$event.stopPropagation()"
  >
    <h2
      class="text-3xl bbh-sans-hegarty-regular w-fit font-semibold bg-gradient-to-r from-[#5fa8fb] to-[#c178e9] bg-clip-text text-transparent mb-5"
    >
      @if(title === 'new'){ Create New Task } @else{Update Task}
    </h2>

    <form (ngSubmit)="onSubmit()" #taskForm="ngForm" class="space-y-4">
      <!-- Task Name -->
      <div>
        <label for="name" class="block text-sm font-medium text-gray-700 mb-1">
          Task Name <span class="text-red-500">*</span>
        </label>
        <input
          type="text"
          id="name"
          name="name"
          [(ngModel)]="task.name"
          required
          class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none"
          placeholder="Enter task title"
        />
      </div>

      <!-- Description -->
      <div>
        <label for="description" class="block text-sm font-medium text-gray-700 mb-1">
          Description
        </label>
        <textarea
          id="description"
          name="description"
          [(ngModel)]="task.description"
          rows="3"
          class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none"
          placeholder="Add task details (optional)"
        ></textarea>
      </div>

      <!-- Date -->
      <div>
        <label for="date" class="block text-sm font-medium text-gray-700 mb-1"> Due Date </label>
        <input
          type="date"
          id="date"
          name="date"
          [(ngModel)]="task.date"
          class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none"
        />
      </div>

      <!-- Category -->
      <div>
        <label for="category" class="block text-sm font-medium text-gray-700 mb-1">
          Category
        </label>
        <input
          type="text"
          id="category"
          name="category"
          [(ngModel)]="task.category"
          placeholder="Work, Personal, Study..."
          class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none"
        />
      </div>

      <!-- Toggles -->
      <div class="flex items-center justify-between">
        <label class="flex items-center space-x-2">
          <input
            type="checkbox"
            name="important"
            [(ngModel)]="task.important"
            class="rounded text-blue-600 focus:ring-blue-500"
          />
          <span class="text-gray-700 text-sm">Mark as Important</span>
        </label>

        <label class="flex items-center space-x-2">
          <input
            type="checkbox"
            name="completed"
            [(ngModel)]="task.completed"
            class="rounded text-blue-600 focus:ring-blue-500"
          />
          <span class="text-gray-700 text-sm">Completed</span>
        </label>
      </div>

      <!-- Buttons -->
      <div class="flex justify-end gap-3 mt-6">
        <button
          type="button"
          (click)="closeForm()"
          class="px-4 py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-100 transition"
        >
          Cancel
        </button>

        <button
          type="submit"
          [disabled]="taskForm.invalid"
          class="px-5 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition disabled:opacity-50"
        >
          @if(title === 'new'){ Save } @else{ Update} Task
        </button>
      </div>
    </form>
  </div>
</div>
